<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BankManagerApp.Views.AccountDetailPage"
             FlowDirection="RightToLeft"
             BackgroundColor="#F8F9FA"
             Title="Ø¬Ø²Ø¦ÛŒØ§Øª Ú©ÛŒÙ Ù¾ÙˆÙ„">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Ø­Ø°Ù" Order="Primary" Priority="0" Clicked="OnDeleteWalletClicked"/>
    </ContentPage.ToolbarItems>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Account Header -->
            <Border StrokeShape="RoundRectangle 20" BackgroundColor="#512BD4" StrokeThickness="0" Padding="20">
                <VerticalStackLayout Spacing="10">
                    <Label x:Name="AccountNameLabel" Text="Ù†Ø§Ù… Ú©ÛŒÙ Ù¾ÙˆÙ„" TextColor="White" FontSize="16" Opacity="0.9"/>
                    <Label x:Name="BalanceLabel" Text="0 ØªÙˆÙ…Ø§Ù†" TextColor="White" FontSize="32" FontAttributes="Bold"/>
                </VerticalStackLayout>
            </Border>

            <!-- New Transaction Section -->
            <Border StrokeShape="RoundRectangle 15" BackgroundColor="White" StrokeThickness="0" Padding="15">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´ Ø¬Ø¯ÛŒØ¯" FontAttributes="Bold" FontSize="16" TextColor="#333"/>
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Grid.Column="0" x:Name="IncomeTab" Text="ðŸ’° ÙˆØ§Ø±ÛŒØ²" Clicked="OnTransactionTypeChanged" BackgroundColor="#E8F5E9" TextColor="#2E7D32" CornerRadius="10" FontAttributes="Bold"/>
                        <Button Grid.Column="1" x:Name="ExpenseTab" Text="ðŸ’¸ Ù‡Ø²ÛŒÙ†Ù‡" Clicked="OnTransactionTypeChanged" BackgroundColor="#F5F5F5" TextColor="#666" CornerRadius="10" FontAttributes="Bold"/>
                    </Grid>

                    <Entry x:Name="AmountEntry" Placeholder="Ù…Ø¨Ù„Øº (ØªÙˆÙ…Ø§Ù†)" Keyboard="Numeric" BackgroundColor="#F5F5F5" TextColor="#333"/>
                    
                    <Picker x:Name="CategoryPicker" Title="Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ" BackgroundColor="#F5F5F5" TextColor="#333">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>Ø­Ù‚ÙˆÙ‚</x:String>
                                <x:String>ÙˆØ§Ø±ÛŒØ² Ø±ÛŒØ§Ù„ÛŒ</x:String>
                                <x:String>Ø¯Ù†Ú¯</x:String>
                                <x:String>Ù†Ù‚Ø¯ÛŒ</x:String>
                                <x:String>Ø³Ø§ÛŒØ±</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>

                    <Entry x:Name="DescriptionEntry" Placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)" BackgroundColor="#F5F5F5" TextColor="#333"/>

                    <Button Text="Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´" Clicked="OnSubmitTransactionClicked" BackgroundColor="#512BD4" TextColor="White" CornerRadius="10" FontAttributes="Bold"/>
                </VerticalStackLayout>
            </Border>

            <!-- Calendar Section -->
            <Border StrokeShape="RoundRectangle 15" BackgroundColor="White" StrokeThickness="0" Padding="15">
                <VerticalStackLayout Spacing="10">
                    <!-- Year Navigation -->
                    <Grid ColumnDefinitions="40,*,40" Margin="0,0,0,5">
                        <Button Grid.Column="0" Text="â®" Clicked="OnNextYearClicked" BackgroundColor="#F5F5F5" TextColor="#512BD4" FontSize="18" FontAttributes="Bold" Padding="0" HeightRequest="40" WidthRequest="40" CornerRadius="20"/>
                        <Button Grid.Column="1" x:Name="CurrentYearLabel" Text="1403" Clicked="OnViewYearStatsClicked" BackgroundColor="Transparent" TextColor="#333" FontAttributes="Bold" FontSize="18" HorizontalOptions="Center"/>
                        <Button Grid.Column="2" Text="â¯" Clicked="OnPrevYearClicked" BackgroundColor="#F5F5F5" TextColor="#512BD4" FontSize="18" FontAttributes="Bold" Padding="0" HeightRequest="40" WidthRequest="40" CornerRadius="20"/>
                    </Grid>

                    <!-- Month Navigation -->
                    <Grid ColumnDefinitions="40,*,40">
                        <Button Grid.Column="0" Text="â®" Clicked="OnNextMonthClicked" BackgroundColor="#F5F5F5" TextColor="#512BD4" FontSize="18" FontAttributes="Bold" Padding="0" HeightRequest="40" WidthRequest="40" CornerRadius="20"/>
                        <Label Grid.Column="1" x:Name="CurrentMonthLabel" Text="Ù…Ø§Ù‡ Ø¬Ø§Ø±ÛŒ" HorizontalOptions="Center" VerticalOptions="Center" FontAttributes="Bold" FontSize="16" TextColor="#333"/>
                        <Button Grid.Column="2" Text="â¯" Clicked="OnPrevMonthClicked" BackgroundColor="#F5F5F5" TextColor="#512BD4" FontSize="18" FontAttributes="Bold" Padding="0" HeightRequest="40" WidthRequest="40" CornerRadius="20"/>
                    </Grid>

                    <!-- Days Header -->
                    <Grid ColumnDefinitions="*,*,*,*,*,*,*">
                        <Label Text="Ø´" HorizontalOptions="Center" TextColor="#888" FontSize="12"/>
                        <Label Grid.Column="1" Text="ÛŒ" HorizontalOptions="Center" TextColor="#888" FontSize="12"/>
                        <Label Grid.Column="2" Text="Ø¯" HorizontalOptions="Center" TextColor="#888" FontSize="12"/>
                        <Label Grid.Column="3" Text="Ø³" HorizontalOptions="Center" TextColor="#888" FontSize="12"/>
                        <Label Grid.Column="4" Text="Ú†" HorizontalOptions="Center" TextColor="#888" FontSize="12"/>
                        <Label Grid.Column="5" Text="Ù¾" HorizontalOptions="Center" TextColor="#888" FontSize="12"/>
                        <Label Grid.Column="6" Text="Ø¬" HorizontalOptions="Center" TextColor="#888" FontSize="12"/>
                    </Grid>

                    <!-- Calendar Grid -->
                    <Grid x:Name="CalendarGrid" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="*,*,*,*,*,*,*" RowSpacing="5" ColumnSpacing="5">
                        <!-- Days will be added dynamically -->
                    </Grid>

                    <!-- Selected Date Stats -->
                    <Border StrokeShape="RoundRectangle 10" BackgroundColor="#F5F5F5" StrokeThickness="0" Padding="10" Margin="0,10,0,0">
                        <Grid ColumnDefinitions="*,*">
                            <VerticalStackLayout Grid.Column="0" Spacing="2">
                                <Label Text="Ø¯Ø±Ø¢Ù…Ø¯" HorizontalOptions="Center" TextColor="#2E7D32" FontSize="12"/>
                                <Label x:Name="SelectedDateIncomeLabel" Text="0" HorizontalOptions="Center" TextColor="#2E7D32" FontAttributes="Bold"/>
                            </VerticalStackLayout>
                            <VerticalStackLayout Grid.Column="1" Spacing="2">
                                <Label Text="Ù‡Ø²ÛŒÙ†Ù‡" HorizontalOptions="Center" TextColor="#C62828" FontSize="12"/>
                                <Label x:Name="SelectedDateExpenseLabel" Text="0" HorizontalOptions="Center" TextColor="#C62828" FontAttributes="Bold"/>
                            </VerticalStackLayout>
                        </Grid>
                    </Border>
                </VerticalStackLayout>
            </Border>

            <!-- Transaction History Header -->
            <Label Text="ØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§" FontSize="16" FontAttributes="Bold" TextColor="#333"/>
            
            <!-- Transactions List (BindableLayout) -->
            <StackLayout x:Name="TransactionsContainer" Spacing="10">
                <BindableLayout.ItemTemplate>
                    <DataTemplate>
                        <Border StrokeShape="RoundRectangle 10" BackgroundColor="White" StrokeThickness="0" Padding="10">
                            <Grid ColumnDefinitions="Auto,*,Auto">
                                <Label Grid.Column="0" Text="{Binding Type, Converter={StaticResource TransactionIconConverter}}" FontSize="24" VerticalOptions="Center" Margin="0,0,10,0"/>
                                
                                <VerticalStackLayout Grid.Column="1" VerticalOptions="Center">
                                    <Label Text="{Binding Category}" FontAttributes="Bold" TextColor="#333"/>
                                    <Label Text="{Binding DateTime, StringFormat='{0:yyyy/MM/dd HH:mm}'}" FontSize="12" TextColor="#888"/>
                                </VerticalStackLayout>
                                
                                <Label Grid.Column="2" Text="{Binding Amount, StringFormat='{0:N0}'}" FontAttributes="Bold" TextColor="{Binding Type, Converter={StaticResource TransactionColorConverter}}" VerticalOptions="Center"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </BindableLayout.ItemTemplate>
            </StackLayout>
            
            <!-- Empty State Label (Visible when no transactions) -->
            <Label x:Name="EmptyStateLabel" 
                   Text="Ù‡Ù†ÙˆØ² ØªØ±Ø§Ú©Ù†Ø´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡" 
                   HorizontalOptions="Center" 
                   TextColor="#888" 
                   IsVisible="False"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
